# bccstego Simulator Suite

This suite contains several Python scripts that allows to simulate the program [eBPF Framework](https://github.com/Ocram95/eBPF-Framework) and calculate different metrics that allow to reveal the presence of network covert channels. In particular:
- ```bcc_sim.py```: allows to simulate [eBPF Framework](https://github.com/Ocram95/eBPF-Framework);
- ```bins_ne_0.py```: allows to compute the number of non-empty bins;
- ```changed_bins.py```: allows to compute the number of bins changed between subsequent sampling interval;
- ```heatmap.py```: allows to create a graphical representation of the evolution of the bins, in terms of heatmap.


# Dependencies
Two libraries are necessary to work with pcapSteg.
- Scapy:
```pip3 install scapy```
- Pandas:
```pip3 install pandas```


# Basic Usage
Let's take a look at the parameters of the ```bcc_sim.py``` script: 
```
$ python3 bcc_sim.py [-h HELP] [-r PCAP] [-b BINS] [-f FIELD] [-i INTERVAL] [-t T_WINDOW] [-w W_WINDOW] [-o OUTPUT] 
```
The three mandatory parameters represent: 
- ```-r PCAP``` it specifies the .pcap file to read and inject.
- ```-b BINS``` it specifies the number of bins to subdivide the space of the values of the field.
- ```-f FIELD``` it specifies the target field to inspect. The available fields are: Flow Label (FL), Traffic Class (TC), and Hop Limit (HL).
- ```-i INTERVAL``` it specifies the sampling interval.
- ```-t T_WINDOW``` it specifies the time window after which the bins are reset.
- ```-w W_WINDOW``` it specifies the amount of samples after which the bins are reset.
- ```-o OUTPUT``` it specifies the name of the .csv output file.

Concerning ```bins_ne_0.py```, ```changed_bins.py```, and ```heatmap.py``` scripts the parameter is the same:
- ```-r CSV``` it specifies the .csv file to read and parse. The .csv file are the ones generated by ```bcc_sim.py```.


## Example Usages
```
$ python3 bcc_sim.py -r file.pcap -b 8  -f TC -i 1 -t 30 -o TC_file_b8_t30.csv
```
This command parses the input pcap file, inspects the Traffic Class field, and fills a bins data structure composed of 2^8 bins. In particular, the bins are updated each second and are reset each 30 seconds.

# Acknowledgement 

This work has been supported by EU Project [SIMARGL](https://simargl.eu) - Secure Intelligent Methods for Advanced Recognition of Malware and Stegomalware, Grant Agreement No 833042.
